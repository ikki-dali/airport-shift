# TICKET-005: ãƒã‚¹ã‚¿ç®¡ç†æ©Ÿèƒ½ - ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
ğŸ“‹ æœªç€æ‰‹

## å„ªå…ˆåº¦
â­â­â­â­â­ æœ€é«˜

## è¤‡é›‘åº¦
Medium

## æ¦‚è¦
ã‚¹ã‚¿ãƒƒãƒ•æƒ…å ±ã®CRUDæ©Ÿèƒ½å®Ÿè£…

## æˆæœç‰©
- [x] `/app/staff/page.tsx` - ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§ãƒšãƒ¼ã‚¸
- [x] `/app/staff/new/page.tsx` - ã‚¹ã‚¿ãƒƒãƒ•è¿½åŠ ãƒšãƒ¼ã‚¸
- [x] `/app/staff/[id]/edit/page.tsx` - ã‚¹ã‚¿ãƒƒãƒ•ç·¨é›†ãƒšãƒ¼ã‚¸
- [x] `/app/staff/[id]/page.tsx` - ã‚¹ã‚¿ãƒƒãƒ•è©³ç´°ãƒšãƒ¼ã‚¸
- [x] `/lib/actions/staff.ts` - Server Actions
- [x] `/components/staff/` - é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  - `StaffTable.tsx` - ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«
  - `StaffForm.tsx` - è¿½åŠ ãƒ»ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ 
  - `StaffSearch.tsx` - æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿

## ä¾å­˜é–¢ä¿‚
- TICKET-002: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ§‹ç¯‰
- TICKET-003: å½¹è·ãƒ»ã‚¿ã‚°ç®¡ç†ï¼ˆå½¹è·ã¨ã‚¿ã‚°ã®ãƒã‚¹ã‚¿ãŒå¿…è¦ï¼‰

## æ©Ÿèƒ½è¦ä»¶

### ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§
- è¡¨ç¤ºé …ç›®
  - ç¤¾å“¡ç•ªå·
  - æ°å
  - é€£çµ¡å…ˆï¼ˆãƒ¡ãƒ¼ãƒ«ã€é›»è©±ï¼‰
  - å½¹è·
  - ä¿æœ‰ã‚¿ã‚°
  - åœ¨ç±çŠ¶æ³
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ50ä»¶/ãƒšãƒ¼ã‚¸ï¼‰
- ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
  - ç¤¾å“¡ç•ªå·é †
  - æ°åé †
  - å½¹è·é †

### æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½
- ç¤¾å“¡ç•ªå·æ¤œç´¢
- æ°åæ¤œç´¢ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰
- å½¹è·ãƒ•ã‚£ãƒ«ã‚¿
- ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰
- åœ¨ç±çŠ¶æ³ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆåœ¨ç±ä¸­/é€€è·ï¼‰

### ã‚¹ã‚¿ãƒƒãƒ•è¿½åŠ 
- å…¥åŠ›é …ç›®
  - ç¤¾å“¡ç•ªå·ï¼ˆ4æ¡æ•°å­—ã€é‡è¤‡ãƒã‚§ãƒƒã‚¯ï¼‰
  - æ°åï¼ˆå¿…é ˆï¼‰
  - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆä»»æ„ã€å½¢å¼ãƒã‚§ãƒƒã‚¯ï¼‰
  - é›»è©±ç•ªå·ï¼ˆä»»æ„ã€å½¢å¼ãƒã‚§ãƒƒã‚¯ï¼‰
  - å½¹è·ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼‰
  - ã‚¿ã‚°ï¼ˆè¤‡æ•°é¸æŠå¯èƒ½ï¼‰
  - åœ¨ç±çŠ¶æ³ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: åœ¨ç±ä¸­ï¼‰

### ã‚¹ã‚¿ãƒƒãƒ•ç·¨é›†
- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ç·¨é›†
- ç¤¾å“¡ç•ªå·ã¯ç·¨é›†ä¸å¯
- ã‚¿ã‚°ã®è¿½åŠ ãƒ»å‰Šé™¤

### ã‚¹ã‚¿ãƒƒãƒ•è©³ç´°
- åŸºæœ¬æƒ…å ±è¡¨ç¤º
- ã‚·ãƒ•ãƒˆå±¥æ­´è¡¨ç¤ºï¼ˆå°†æ¥å®Ÿè£…ï¼‰
- å¸Œæœ›æå‡ºå±¥æ­´ï¼ˆå°†æ¥å®Ÿè£…ï¼‰

### åœ¨ç±çŠ¶æ³ç®¡ç†
- åœ¨ç±ä¸­ â‡” é€€è·ã®ãƒˆã‚°ãƒ«
- é€€è·è€…ã¯ä¸€è¦§ã§ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆè¡¨ç¤º
- é€€è·è€…ã®ã‚·ãƒ•ãƒˆå‰²ã‚Šå½“ã¦ã¯ä¸å¯

## UIè¨­è¨ˆ

### ä¸€è¦§ç”»é¢
```
+--------------------------------------------------+
| [æ–°è¦ã‚¹ã‚¿ãƒƒãƒ•è¿½åŠ ]                        [æ¤œç´¢ğŸ”] |
+--------------------------------------------------+
| ãƒ•ã‚£ãƒ«ã‚¿: [å½¹è·â–¼] [ã‚¿ã‚°â–¼] [åœ¨ç±çŠ¶æ³â–¼]              |
+--------------------------------------------------+
| ç¤¾å“¡ç•ªå· | æ°å | ãƒ¡ãƒ¼ãƒ« | å½¹è· | ã‚¿ã‚° | æ“ä½œ     |
+--------------------------------------------------+
| 0001 | å±±ç”°å¤ªéƒ | ... | ãƒªãƒ¼ãƒ€ãƒ¼ | ... | [ç·¨é›†][å‰Šé™¤] |
| 0002 | ä½è—¤èŠ±å­ | ... | ä¸€èˆ¬ | ... | [ç·¨é›†][å‰Šé™¤] |
+--------------------------------------------------+
```

### è¿½åŠ ãƒ»ç·¨é›†ç”»é¢
```
+--------------------------------------------------+
| ã‚¹ã‚¿ãƒƒãƒ•æƒ…å ±å…¥åŠ›                                   |
+--------------------------------------------------+
| ç¤¾å“¡ç•ªå·: [____] (4æ¡æ•°å­—)                         |
| æ°å: [________________]                          |
| ãƒ¡ãƒ¼ãƒ«: [________________]                        |
| é›»è©±: [________________]                          |
| å½¹è·: [é¸æŠã—ã¦ãã ã•ã„â–¼]                          |
| ã‚¿ã‚°: [â˜‘ä¿å®‰æ¤œæŸ»] [â˜ãƒã‚¹æ¡ˆå†…] [â˜æ¨ªç‰¹]             |
| åœ¨ç±çŠ¶æ³: [âš«åœ¨ç±ä¸­] [â—‹é€€è·]                      |
|                                                  |
| [ã‚­ãƒ£ãƒ³ã‚»ãƒ«] [ä¿å­˜]                               |
+--------------------------------------------------+
```

## ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ç¤¾å“¡ç•ªå·: å¿…é ˆã€4æ¡æ•°å­—ã€é‡è¤‡ä¸å¯
- æ°å: å¿…é ˆã€1-50æ–‡å­—
- ãƒ¡ãƒ¼ãƒ«: å½¢å¼ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰
- é›»è©±: å½¢å¼ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰
- å½¹è·: rolesãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é¸æŠ
- ã‚¿ã‚°: tagsãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é¸æŠï¼ˆè¤‡æ•°å¯ï¼‰

## Server Actionså®Ÿè£…ä¾‹

```typescript
'use server'

import { createClient } from '@/lib/supabase/server'
import { revalidatePath } from 'next/cache'

export async function getStaff(filters?: {
  search?: string
  roleId?: string
  tags?: string[]
  isActive?: boolean
}) {
  const supabase = await createClient()

  let query = supabase
    .from('staff')
    .select(`
      *,
      roles (
        id,
        name,
        is_responsible
      )
    `)
    .order('employee_number')

  if (filters?.search) {
    query = query.or(`name.ilike.%${filters.search}%,employee_number.ilike.%${filters.search}%`)
  }

  if (filters?.roleId) {
    query = query.eq('role_id', filters.roleId)
  }

  if (filters?.isActive !== undefined) {
    query = query.eq('is_active', filters.isActive)
  }

  const { data, error } = await query

  if (error) throw error
  return data
}

export async function createStaff(formData: FormData) {
  const supabase = await createClient()

  const staff = {
    employee_number: formData.get('employee_number') as string,
    name: formData.get('name') as string,
    email: formData.get('email') as string || null,
    phone: formData.get('phone') as string || null,
    role_id: formData.get('role_id') as string || null,
    tags: formData.getAll('tags') as string[],
    is_active: formData.get('is_active') === 'on',
  }

  const { error } = await supabase.from('staff').insert(staff)

  if (error) throw error

  revalidatePath('/staff')
}

// updateStaff, deleteStaff ã‚‚åŒæ§˜ã«å®Ÿè£…
```

## ãƒ†ã‚¹ãƒˆé …ç›®
- [ ] ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] æ¤œç´¢æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹
- [ ] ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹
- [ ] ã‚¹ã‚¿ãƒƒãƒ•ã®è¿½åŠ ãŒã§ãã‚‹
- [ ] ç¤¾å“¡ç•ªå·ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯ãŒæ©Ÿèƒ½ã™ã‚‹
- [ ] ã‚¹ã‚¿ãƒƒãƒ•ã®ç·¨é›†ãŒã§ãã‚‹
- [ ] ã‚¿ã‚°ã®è¤‡æ•°é¸æŠãŒã§ãã‚‹
- [ ] åœ¨ç±çŠ¶æ³ã®åˆ‡ã‚Šæ›¿ãˆãŒã§ãã‚‹
- [ ] ã‚¹ã‚¿ãƒƒãƒ•ã®å‰Šé™¤ãŒã§ãã‚‹
- [ ] ä½¿ç”¨ä¸­ã®ã‚¹ã‚¿ãƒƒãƒ•ã¯å‰Šé™¤ã§ããªã„
- [ ] ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ©Ÿèƒ½ã™ã‚‹

## å®Œäº†æ¡ä»¶
- [ ] ã‚¹ã‚¿ãƒƒãƒ•ã®CRUDæ©Ÿèƒ½ãŒå…¨ã¦å‹•ä½œã™ã‚‹
- [ ] æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãŒæ­£ã—ãæ©Ÿèƒ½ã™ã‚‹
- [ ] å½¹è·ãƒ»ã‚¿ã‚°ã¨ã®é€£æºãŒæ­£ã—ã„
- [ ] UI/UXãŒç›´æ„Ÿçš„

## è¦‹ç©ã‚‚ã‚Šå·¥æ•°
8-10æ™‚é–“

## é–‹å§‹äºˆå®šæ—¥
2025-11-16

## å®Œäº†äºˆå®šæ—¥
2025-11-17
